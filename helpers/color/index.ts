// type RGB = [number, number, number];
export type Colormap = [number, number, number][];

export const colormaps: { name: string, value: Colormap }[] = [
  {
    name: "viridis",
    value: [
      [253, 231, 37],
      [188, 223, 39],
      [122, 209, 81],
      [67, 191, 113],
      [34, 168, 132],
      [33, 145, 141],
      [42, 120, 142],
      [53, 96, 141],
      [65, 68, 135],
      [72, 37, 117],
      [68, 1, 84],
    ]
  },
  {
    name: "magma",
    value: [
      [252, 253, 191],
      [254, 206, 145],
      [254, 159, 109],
      [247, 111, 92],
      [222, 73, 104],
      [182, 55, 122],
      [140, 41, 129],
      [101, 26, 128],
      [59, 15, 112],
      [21, 14, 55],
      [0, 0, 4],
    ]
  },
  {
    name: "inferno", 
    value: [
      [252, 255, 164],
      [246, 214, 69],
      [252, 165, 10],
      [243, 119, 26],
      [221, 81, 58],
      [187, 55, 85],
      [147, 38, 103],
      [107, 23, 110],
      [66, 10, 104],
      [23, 12, 59],
      [0, 0, 4],
    ]
  },
  {
    name: "plasma", 
    value: [
      [240, 249, 33],
      [252, 206, 37],
      [252, 166, 54],
      [242, 131, 76],
      [225, 100, 98],
      [203, 71, 121],
      [177, 42, 144],
      [144, 13, 164],
      [106, 0, 168],
      [66, 3, 157],
      [13, 8, 135],
    ]
  }, 
  {
    name: "cividis", 
    value: [
      [253, 234, 69],
      [234, 209, 86],
      [202, 186, 106],
      [173, 164, 118],
      [148, 143, 120],
      [127, 124, 117],
      [105, 105, 112],
      [77, 86, 109],
      [43, 68, 110],
      [10, 50, 106],
      [0, 32, 81],
    ]
  },
  {
    name: "turbo",
    value: [
      [144, 12, 0],
      [186, 34, 8],
      [246, 95, 24],
      [255, 164, 35],
      [222, 221, 50],
      [149, 251, 81],
      [77, 248, 132],
      [39, 215, 196],
      [47, 157, 245],
      [74, 88, 221],
      [35, 23, 27],
    ]
  },
  {
    name: "bluegreen", 
    value: [
      [213, 239, 237],
      [193, 232, 224],
      [167, 221, 209],
      [139, 210, 190],
      [112, 198, 169],
      [88, 186, 145],
      [68, 173, 119],
      [49, 156, 93],
      [32, 137, 70],
      [14, 119, 54],
      [3, 100, 41],
    ]
  },
  {
    name: "bluepurple", 
    value: [
      [204, 221, 236],
      [186, 208, 228],
      [168, 194, 221],
      [154, 176, 212],
      [145, 156, 201],
      [141, 133, 190],
      [139, 109, 178],
      [138, 85, 166],
      [135, 60, 153],
      [130, 34, 135],
      [115, 15, 113],
    ]
  },
  {
    name: "goldengreen", 
    value: [
      [244, 209, 102],
      [213, 202, 96],
      [182, 195, 92],
      [152, 187, 89],
      [124, 178, 87],
      [96, 166, 86],
      [75, 156, 83],
      [63, 143, 79],
      [51, 131, 74],
      [37, 119, 64],
      [20, 108, 54],
    ]
  },
  {
    name: "goldorange", 
    value: [
      [244, 209, 102],
      [248, 190, 92],
      [248, 170, 76],
      [245, 152, 59],
      [243, 133, 42],
      [239, 112, 27],
      [226, 98, 31],
      [214, 83, 34],
      [197, 73, 35],
      [177, 66, 35],
      [158, 58, 38],
    ]
  },
  {
    name: "goldred", 
    value: [
      [244, 209, 102],
      [246, 190, 89],
      [249, 170, 81],
      [252, 150, 78],
      [246, 131, 75],
      [238, 115, 74],
      [229, 98, 73],
      [219, 82, 71],
      [207, 66, 68],
      [196, 49, 65],
      [183, 29, 62],
    ]
  },
  {
    name: "greenblue", 
    value: [
      [211, 238, 206],
      [197, 232, 195],
      [177, 225, 187],
      [155, 216, 187],
      [130, 206, 194],
      [105, 194, 202],
      [81, 178, 205],
      [60, 159, 199],
      [40, 138, 189],
      [22, 117, 177],
      [11, 96, 161],
    ]
  },
  {
    name: "orangered", 
    value: [
      [253, 220, 175],
      [253, 207, 155],
      [253, 193, 138],
      [253, 173, 119],
      [251, 149, 98],
      [246, 125, 83],
      [238, 101, 69],
      [226, 73, 50],
      [211, 45, 30],
      [191, 19, 13],
      [167, 4, 3],
    ]
  },
  {
    name: "purplebluegreen", 
    value: [
      [219, 216, 234],
      [200, 206, 228],
      [176, 195, 222],
      [147, 183, 216],
      [114, 172, 209],
      [84, 159, 200],
      [56, 146, 187],
      [28, 136, 163],
      [9, 127, 135],
      [2, 115, 107],
      [1, 99, 83],
    ]
  },
  {
    name: "purpleblue", 
    value: [
      [219, 218, 235],
      [200, 206, 228],
      [177, 195, 222],
      [151, 183, 216],
      [123, 172, 209],
      [91, 159, 201],
      [58, 144, 192],
      [30, 127, 183],
      [11, 112, 171],
      [5, 97, 153],
      [4, 82, 129],
    ]
  },
  {
    name: "purplered", 
    value: [
      [220, 201, 226],
      [211, 179, 215],
      [206, 158, 204],
      [209, 134, 192],
      [218, 107, 178],
      [225, 77, 160],
      [226, 49, 137],
      [217, 30, 111],
      [198, 17, 89],
      [171, 7, 73],
      [143, 2, 58],
    ]
  },
  {
    name: "redpurple", 
    value: [
      [252, 207, 204],
      [252, 190, 192],
      [250, 169, 184],
      [249, 143, 175],
      [245, 113, 165],
      [236, 83, 157],
      [219, 54, 149],
      [196, 27, 138],
      [169, 8, 128],
      [141, 1, 121],
      [112, 1, 116],
    ]
  },
  {
    name: "yellowgreenblue", 
    value: [
      [239, 249, 189],
      [219, 241, 180],
      [189, 229, 181],
      [148, 213, 185],
      [105, 197, 190],
      [69, 180, 194],
      [44, 158, 192],
      [33, 130, 184],
      [33, 99, 170],
      [35, 71, 156],
      [28, 49, 133],
    ]
  },
  {
    name: "yellowgreen", 
    value: [
      [228, 244, 172],
      [209, 236, 160],
      [185, 226, 148],
      [158, 214, 136],
      [128, 201, 124],
      [98, 187, 110],
      [71, 170, 94],
      [50, 151, 80],
      [32, 131, 68],
      [14, 114, 59],
      [3, 96, 52],
    ]
  },
  {
    name: "yelloworangebrown", 
    value: [
      [254, 234, 161],
      [254, 221, 132],
      [254, 204, 99],
      [254, 183, 70],
      [252, 160, 49],
      [246, 137, 33],
      [235, 114, 21],
      [219, 94, 11],
      [197, 76, 5],
      [171, 61, 3],
      [143, 50, 4],
    ]
  },
  {
    name: "yelloworangered", 
    value: [
      [254, 224, 135],
      [254, 209, 111],
      [254, 189, 89],
      [254, 168, 73],
      [253, 144, 62],
      [252, 115, 53],
      [249, 82, 43],
      [238, 52, 35],
      [222, 27, 32],
      [202, 11, 34],
      [175, 2, 37],
    ]
  },
]

export function getColorScale(id: number): (weight: number) => [number, number, number]{
  const colorMap = colormaps[id];
  if(!colorMap) return () => [0, 0, 0];
  const values = colorMap.value;
  return (weight: number) => values[Math.round(weight * (values.length-1))];
}

export function getRandomColor(colorMap: Colormap) {

    function luminance(r: number, g: number, b: number) {
        var a = [r, g, b].map(function (v) {
            v /= 255;
            return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);
        });
        return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
    }

    function contrast(rgb1: [number, number, number], rgb2: [number, number, number]) {
        var lum1 = luminance(rgb1[0], rgb1[1], rgb1[2]);
        var lum2 = luminance(rgb2[0], rgb2[1], rgb2[2]);
        var brightest = Math.max(lum1, lum2);
        var darkest = Math.min(lum1, lum2);
        return (brightest + 0.05) / (darkest + 0.05);
    }

    // const r = seedrandom(id);
    let res: [number, number, number] = new Array(3).fill(0).map(() => Math.floor(Math.random() * 255)) as [number, number, number];
    while (contrast(res, [255, 255, 255]) < 3) {
        res = new Array(3).fill(0).map(() => Math.floor(Math.random() * 255)) as [number, number, number];
    }
    return res;
}
